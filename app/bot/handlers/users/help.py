from telebot.types import Message

from app.models import User
from ...base import base
from ...helpers import send_message_private
from ...keyboards.inline import get_help_inline_markup
from ...loader import bot


@bot.message_handler(regexp='^üÜò –î–æ–ø–æ–º–æ–≥–∞$')
@bot.message_handler(commands=['help'])
@base()
def help_handler(message: Message, current_user: User):
    text = '\n'.join(
        ('üÜò –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è\n',
         '/info - –î—ñ–∑–Ω–∞—Ç–∏—Å—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É',
         '/schedule - –î—ñ–∑–Ω–∞—Ç–∏—Å—å —Ä–æ–∑–∫–ª–∞–¥',
         '/homework - –î—ñ–∑–Ω–∞—Ç–∏—Å—å –¥–æ–º–∞—à–Ω—î –∑–∞–≤–¥–∞–Ω–Ω—è',
         '/today_homework - –î—ñ–∑–Ω–∞—Ç–∏—Å—å –¥–æ–º–∞—à–Ω—î –∑–∞–≤–¥–∞–Ω–Ω—è, —è–∫—ñ –∑–∞–¥–∞–ª–∏ —Å—å–æ–≥–æ–¥–Ω—è',
         '/current_info - –î—ñ–∑–Ω–∞—Ç–∏—Å—å, —Å–∫—ñ–ª—å–∫–∏ —á–∞—Å—É –∑–∞–ª–∏—à–∏–ª–æ—Å—å –¥–æ –∫—ñ–Ω—Ü—è –ø–∞—Ä–∏ –∏ —è–∫–∞ –ø–∞—Ä–∞ –±—É–¥–µ –Ω–∞—Å—Ç—É–ø–Ω–∞\n',
         '/help - –î–æ–ø–æ–º–æ–≥–∞ –ø–æ –±–æ—Ç—É',
         '/keyboard - –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä—É',
         '/keyboard_off - –í—ñ–¥–∫–ª—é—á–∏—Ç–∏ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä—É\n'))
    reply_markup = None

    if current_user.is_admin():
        text += '\n'.join(
            ('\nüëë –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –¥–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤\n',
             '<i>–î–æ–º–∞—à–Ω—î –∑–∞–≤–¥–∞–Ω–Ω—î –º–æ–∂–Ω–∞ –¥–æ–¥–∞–≤–∞—Ç–∏ –ø–æ —à–≤–∏–¥–∫–æ–º—É —à–∞–±–ª–æ–Ω—É</i>',
             '<pre>!–ù–∞–∑–≤–∞ –ø—Ä–µ–¥–º–µ—Ç—É - –∑–∞–≤–∞–¥–∞–Ω–Ω—è</pre>\n',
             '/add - –î–æ–¥–∞—Ç–∏ –¥–æ–º–∞—à–Ω—î –∑–∞–≤–¥–∞–Ω–Ω—è',
             '/edit - –ó–º—ñ–Ω–∏—Ç—Ç –¥–æ–º–∞—à–Ω—î –∑–∞–¥–∞–Ω–Ω—è\n',
             '/add_file - –î–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª –≤ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É\n',
             '/users_list - –û—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤\n',
             '/get_id - –û—Ç—Ä–∏–º–∞—Ç–∏ id –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (id –ø—Ä–∏–π–¥–µ –≤ –æ—Å–æ–±–∏—Å—Ç—ñ)',
             '/get_file_id - –û—Ç—Ä–∏–º–∞—Ç–∏ id —Ñ–∞–π–ª—É',
             '/delete - –í–∏–¥–∞–ª–∏—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±–æ—Ç—É',
             '/call_all - –ü–æ–∫–ª–∏–∫–∞—Ç–∏ –≤—Å—ñ—Ö —É—á–∞—Å—Ç–Ω–∏–∫—ñ–≤ –≥—Ä—É–ø–∏\n')
        )

    markup = get_help_inline_markup(current_user.is_admin())

    send_message_private(message, text, reply_markup=markup)
